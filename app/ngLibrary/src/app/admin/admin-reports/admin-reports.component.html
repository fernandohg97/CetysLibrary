<!-- Admin Reports -->
<div class="grid-container reports-content">
  <!-- Admin reports title -->
  <div class="grid-x grid-padding-x">
    <div class="small-12 cell">
      <h2 class="text-center">Reporte estad&iacute;stico</h2>
    </div>
  </div>
  <!-- Initial Date input -->
  <div class="grid-x grid-padding-x">
    <div class="small-6 cell">
      <label>Fecha Inicio
        <input type="date" name="startDate" [(ngModel)]="startDate" placeholder="Fecha" required>
      </label>
    </div>
    <!-- Last date input -->
    <div class="small-6 cell">
      <label>Fecha Fin
        <input type="date" name="endDate" [(ngModel)]="endDate" placeholder="Fecha" required>
      </label>
    </div>
  </div>
  <!-- Search button -->
  <div class="grid-x grid-padding-x">
    <div class="small-12 cell">
      <button type="button" class="button radius shadow" name="button" (click)="searchReports()">Buscar</button>
    </div>
    <!-- Total reservations message -->
    <!-- <div class="small-6 cell text-right">
      <h6><u><strong>Total de reservaciones: {{totalReservations}}</strong></u></h6>
    </div> -->
  </div>
    <!-- Reports -->
    <div class="grid-x grid-padding-x">
    <!-- Cubicle Reports -->
      <div *ngIf="reportsCubicle?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4 aria-describedby="cubicleCount">Reservaciones por cub&iacute;culo - {{totalSumCubicle}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Cub&iacute;culo</th>
              <th>Cantidad de reservaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reportsCubicle">
              <td>{{report._id}}</td>
              <td>{{report.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto;">
          <canvas  width="400" height="400" *ngIf="pieChartLabelsCubicles?.length > 0 && pieChartDataCubicles?.length > 0" baseChart
                  [data]="pieChartDataCubicles"
                  [labels]="pieChartLabelsCubicles"
                  [chartType]="pieChartType">
          </canvas>
        </div>
      </div>
      <!-- Division Reports -->
      <div *ngIf="reportsDivision?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4>Reservaciones por divisi&oacute;n (estudiantes) - {{totalSumDivision}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Divisi&oacute;n</th>
              <th>Cantidad de reservaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reportsDivision">
              <td>{{report._id}}</td>
              <td>{{report.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto;">
          <canvas width="300" height="300" *ngIf="pieChartLabelsDivision?.length > 0 && pieChartDataDivision?.length > 0" baseChart
                  [data]="pieChartDataDivision"
                  [labels]="pieChartLabelsDivision"
                  [chartType]="pieChartType">
          </canvas>
        </div>
      </div>
      <!-- Careers Reports -->
      <div *ngIf="reportsCareer?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4>Reservaciones por carrera (l&iacute;der) - {{totalSumCareer}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Carrera</th>
              <th>Cantidad de reservaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reportsCareer">
              <td>{{report._id}}</td>
              <td>{{report.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto;">
          <canvas width="300" height="300" *ngIf="pieChartLabelsCareers?.length > 0 && pieChartDataCareers?.length > 0" baseChart
                  [data]="pieChartDataCareers"
                  [labels]="pieChartLabelsCareers"
                  [chartType]="pieChartType">
          </canvas>
        </div>
      </div>
      <!-- Departments Reports -->
      <div *ngIf="reportsDepartment?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4>Reservaciones por departamento (l&iacute;der) - {{totalSumDepartment}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Departmento</th>
              <th>Cantidad de reservaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reportsDepartment">
              <td>{{report._id}}</td>
              <td>{{report.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto;">
          <canvas width="300" height="300" *ngIf="pieChartLabelsDepartments?.length > 0 && pieChartDataDepartments?.length > 0" baseChart
                  [data]="pieChartDataDepartments"
                  [labels]="pieChartLabelsDepartments"
                  [chartType]="pieChartType">
          </canvas>
        </div>
      </div>
      <!-- Companions Reports -->
      <div *ngIf="reportsCompanions?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4>Reservaciones por carrera/departmento (acompa単antes) - {{totalSumCompanions}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Carrera</th>
              <th>Cantidad de ingresos</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reportsCompanions; let i = index">
              <td>{{report._id}}</td>
              <td>{{report.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto;"> <!-- Companions Chart -->
          <canvas width="500" height="500" *ngIf="pieChartLabelsCompanions?.length > 0 && pieChartDataCompanions?.length > 0" baseChart
                  [data]="pieChartDataCompanions"
                  [labels]="pieChartLabelsCompanions"
                  [chartType]="pieChartType">
          </canvas>
        </div>
      </div>
      <!-- External users Reports -->
      <div *ngIf="reportsExternal?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4>Reservaciones por externo - {{totalSumExternal}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Usuario</th>
              <th>Cantidad de reservaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let external of reportsExternal">
              <td>{{external._id}}</td>
              <td>{{external.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto;">
          <canvas width="300" height="300" *ngIf="pieChartLabelsExternal?.length > 0 && pieChartDataExternal?.length > 0" baseChart
                  [data]="pieChartDataExternal"
                  [labels]="pieChartLabelsExternal"
                  [chartType]="pieChartType">
          </canvas>
        </div>
      </div>
      <!-- Per day Reports -->
      <div *ngIf="reportsDay?.length != 0" class="grid-x grid-padding-x">
        <div class="category-title cell">
          <h4>Reservaciones total por d&iacute;a - {{totalSumDay}}</h4>
        </div>
        <table>
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Cantidad de reservaciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let report of reportsDay; let i = index">
              <td>{{report._id}}</td>
              <td>{{report.ingresos}}</td>
            </tr>
          </tbody>
        </table>
        <div style="display: block; margin: 0 auto; padding: 20px;">
          <canvas width="450" height="450" *ngIf="pieChartLabelsDays?.length > 0 && pieChartDataDays[0]?.data?.length > 0" baseChart
                [datasets]="pieChartDataDays"
                [labels]="pieChartLabelsDays"
                [chartType]="'line'">
          </canvas>
        </div>
    </div>
  </div>
  <div *ngIf="totalSumCubicle" class="grid-x grid-padding-x">
      <div class="small-12 cell">
        <h5><strong>Resumen de per&iacute;odo - {{totalSumCubicle}} reservaciones</strong></h5>
        <ul class="vertical menu">
          <li>Total de reservaciones por cub&iacute;culo: {{totalSumCubicle}}</li>
          <li>Total de reservaciones por divisi&oacute;n: {{totalSumDivision}}</li>
          <li>Total de reservaciones por carrera: {{totalSumCareer}}</li>
          <li>Total de reservaciones por departamento: {{totalSumDepartment}}</li>
          <li>Total de acompa単antes: {{totalSumCompanions}} </li>
          <li>Total de reservaciones por d&iacute;a: {{totalSumDay}}</li>
          <li>Total de reservaciones por externo/visitante: {{totalSumExternal}}</li>
          <!-- <li>Total de estudiantes por carrera (incluye acompa単antes y lideres):</li>
            <ul *ngFor="let career of sumCareers">
              <li>{{career.name}}: {{career.count}}</li>
            </ul>
          <li>Total de empleados por departamento (incluye acompa単antes y lideres):</li>
          <ng-template *ngIf="sumDepartments.length > 0; else elseBlock">
            <ul *ngFor="let department of sumDepartments">
              <li>{{department.name}}: {{department.count}}</li>
            </ul>
          </ng-template>
          <ng-template #elseBlock>No hay repetidos</ng-template> -->
        </ul>
      </div>
  </div>
</div>
<ng-template #elseBlock>No hay resultados</ng-template> <!-- No result message -->
